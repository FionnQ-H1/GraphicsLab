<!DOCTYPE html>

<html>

<head>
  <meta charset="UTF-8">
  <title>Canvas</title>

  <style type="text/css">
    body {
      background-color: white;
    }

    /* Added border for canvas */
    canvas {
      border: 10px solid black;
    }
  </style>

</head>

<body>

  <!-- Added name above canvas-->
  <h1> Fionn Qualter </h1>
  <!-- Added canvas paramaters  -->
  <canvas id="canvas-for-ball" width="400" height="400"></canvas>

  <script type="text/javascript">
    // Gets a handle to the element with id canvasOne.
    var canvas = document.getElementById("canvas-for-ball");
    // Get a 2D context for the canvas.
    var ctx = canvas.getContext("2d");


    class PacManBall {
      constructor(x, y, r, dx, dy) {
        this.x = x;
        this.y = y;
        this.r = r;
        this.dx = dx;
        this.dy = dy;

        this.rotation = 0;
        this.rotationSpeed= 0.05;
        this.mouthPhase = 0;
        this.mouthSpeed = 0.15;
      }

      heading() {
        return Math.atan2(this.dy, this.dx);
      }
    
      draw(ctx) {
        this.mouthPhase += this.mouthSpeed;
        const mouth = 0.5 + 0.3 * Math.sin(this.mouthPhase);
        const angle = this.heading() + this.rotation;

        const start = angle + mouth / 2;
        const end = angle + Math.PI * 2 - mouth / 2;

        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.arc(this.x, this.y, this.r, start, end, false);
        ctx.closePath();
        ctx.fillStyle = "#f5d10d";
        ctx.fill();
        ctx.lineWidth = 2;
        ctx.stroke();

        const eyeAngle = angle - Math.PI / 2;
        const ex = this.x + (this.r * 0.4) * Math.cos(eyeAngle);
        const ey = this.y + (this.r * 0.4) * Math.sin(eyeAngle);
        ctx.beginPath();
        ctx.arc(ex, ey, Math.max(1.5, this.r * 0.08), 0, Math.PI * 2);
        ctx.fillStyle = "#111";
        ctx.fill();
      }

      move(canvas) {
        this.x += this.dx;
        this.y += this.dy;

        if (this.y + this.r >= canvas.height) {
          this.y = canvas.height - this.r;
          this.dy = -Math.abs(this.dy);
          this.rotationSpeed = -this.rotationSpeed;
        }
        if (this.y - this.r <= 0) {
          this.y = this.r;
          this.dy = Math.abs(this.dy);
          this.rotationSpeed = -this.rotationSpeed;
        }

        if (this.x + this.r >= canvas.width) {
          this.x = canvas.width - this.r;
          this.dx = -Math.abs(this.dx);
          this.rotationSpeed = -this.rotationSpeed;
        }
        if (this.x - this.r <= 0) {
          this.x = this.r;
          this.dx = Math.abs(this.dx);
          this.rotationSpeed = -this.rotationSpeed;
        }
      }

      resize(newR) {
        this.r = Math.max(4, newR);
      }

      rotate(dRadians) {
        this.rotation += dRadians;
      }
    }

    // Added empty Paddle class (Step 2)
    class Paddle {
      constructor(x, y, width, height, speed) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
        this.speed = speed || 6;
      }
    }

    var pac = new PacManBall(80, 320, 22, 7, -3);

    function repeatme() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      pac.move(canvas);
      pac.draw(ctx);
      window.requestAnimationFrame(repeatme);
    }

    repeatme();
  </script>

</body>

</html>
